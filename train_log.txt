------------------------------
BASELINE
train shape:  (125400, 16)
val shape:  (3135, 16)

Training Features:  ['year', 'month', 'pct_bb', 'pct_college', 'pct_foreign_born', 'pct_it_workers', 'median_hh_inc']
train shape:  (122265, 16)
val shape:  (3135, 16)

Model:  xgbregressor
smape score:  26.5953

Model:  lgbmregressor
smape score:  32.3634

model: nn.Linear
[1/6] Training loss: 20.3545	 Validation loss: 46.0753
[2/6] Training loss: 18.2439	 Validation loss: 43.9409
[3/6] Training loss: 18.0488	 Validation loss: 44.3468
[4/6] Training loss: 17.9769	 Validation loss: 44.6607
[5/6] Training loss: 17.9435	 Validation loss: 44.8539
[6/6] Training loss: 17.9268	 Validation loss: 44.9524
smape score:  82.31928

model: LSTM
[5/30] Training loss: 18.5948	 Validation loss: 38.1239
[10/30] Training loss: 18.4034	 Validation loss: 35.2185
[15/30] Training loss: 18.3145	 Validation loss: 33.9995
[20/30] Training loss: 18.2445	 Validation loss: 33.4486
[25/30] Training loss: 18.1706	 Validation loss: 33.1346
[30/30] Training loss: 18.0785	 Validation loss: 32.8932
smape score:  49.85586

model: GRU
[5/30] Training loss: 18.6035	 Validation loss: 38.4761
[10/30] Training loss: 18.3847	 Validation loss: 34.9003
[15/30] Training loss: 18.3426	 Validation loss: 33.5680
[20/30] Training loss: 18.2997	 Validation loss: 32.8272
[25/30] Training loss: 18.2611	 Validation loss: 32.4863
[30/30] Training loss: 18.2003	 Validation loss: 32.1374
smape score:  45.154
------------------------------
LAGS ONLY
Preparing shift feature...
Data shape:  (128535, 16)
train shape:  (87780, 28)
val shape:  (3135, 28)

Training Features:  ['year', 'month', 'pct_bb', 'pct_college', 'pct_foreign_born', 'pct_it_workers', 'median_hh_inc', 'mbd_lag_1', 'mbd_lag_2', 'mbd_lag_3', 'mbd_lag_4', 'mbd_lag_5', 'mbd_lag_6', 'mbd_lag_7', 'mbd_lag_8', 'mbd_lag_9', 'mbd_lag_10', 'mbd_lag_11', 'mbd_lag_12']
train shape:  (84645, 28)
val shape:  (3135, 28)

Model:  xgbregressor
smape score:  2.2047

Model:  lgbmregressor
smape score:  2.1734

model: nn.Linear
[1/6] Training loss: 20.7994	 Validation loss: 20.6981
[2/6] Training loss: 6.1953	 Validation loss: 14.6940
[3/6] Training loss: 3.8174	 Validation loss: 12.3990
[4/6] Training loss: 3.3551	 Validation loss: 11.1940
[5/6] Training loss: 2.9954	 Validation loss: 9.4248
[6/6] Training loss: 2.7266	 Validation loss: 7.8271
smape score:  73.99396

model: LSTM
[5/30] Training loss: 6.5394	 Validation loss: 19.6570
[10/30] Training loss: 3.8469	 Validation loss: 16.8171
[15/30] Training loss: 3.7404	 Validation loss: 18.9639
[20/30] Training loss: 3.3379	 Validation loss: 14.6413
[25/30] Training loss: 2.2561	 Validation loss: 11.4056
[30/30] Training loss: 1.8859	 Validation loss: 9.0918
smape score:  20.8884

model: GRU
[5/30] Training loss: 5.7153	 Validation loss: 22.0834
[10/30] Training loss: 3.5096	 Validation loss: 15.2770
[15/30] Training loss: 2.7353	 Validation loss: 15.2706
[20/30] Training loss: 2.4822	 Validation loss: 12.8645
[25/30] Training loss: 2.2235	 Validation loss: 8.8448
[30/30] Training loss: 1.9695	 Validation loss: 11.0832
smape score:  36.28307
------------------------------
LAGS + CFIPS
Preparing shift feature...
Data shape:  (128535, 16)
train shape:  (87780, 28)
val shape:  (3135, 28)
Preparing cfips feature...

Training Features:  ['year', 'month', 'pct_bb', 'pct_college', 'pct_foreign_born', 'pct_it_workers', 'median_hh_inc', 'mbd_lag_1', 'mbd_lag_2', 'mbd_lag_3', 'mbd_lag_4', 'mbd_lag_5', 'mbd_lag_6', 'mbd_lag_7', 'mbd_lag_8', 'mbd_lag_9', 'mbd_lag_10', 'mbd_lag_11', 'mbd_lag_12', 'microbusiness_density_mean', 'microbusiness_density_std', 'trend']
train shape:  (84645, 31)
val shape:  (3135, 31)

Model:  xgbregressor
smape score:  2.2457

Model:  lgbmregressor
smape score:  2.3103

model: nn.Linear
[1/6] Training loss: 20.0939	 Validation loss: 15.7026
[2/6] Training loss: 4.2135	 Validation loss: 6.6799
[3/6] Training loss: 2.9307	 Validation loss: 5.7254
[4/6] Training loss: 2.6960	 Validation loss: 4.8868
[5/6] Training loss: 2.4990	 Validation loss: 4.3124
[6/6] Training loss: 2.3320	 Validation loss: 4.1078
smape score:  11.63838

model: LSTM
[5/30] Training loss: 6.3647	 Validation loss: 15.5974
[10/30] Training loss: 3.7874	 Validation loss: 10.8232
[15/30] Training loss: 2.9457	 Validation loss: 9.1426
[20/30] Training loss: 3.2156	 Validation loss: 9.0192
[25/30] Training loss: 2.0761	 Validation loss: 8.1306
[30/30] Training loss: 1.6983	 Validation loss: 6.4705
smape score:  20.43111

model: GRU
[5/30] Training loss: 5.8045	 Validation loss: 13.5772
[10/30] Training loss: 3.6470	 Validation loss: 9.2951
[15/30] Training loss: 3.5993	 Validation loss: 12.4080
[20/30] Training loss: 2.0430	 Validation loss: 6.1563
[25/30] Training loss: 2.1590	 Validation loss: 4.6319
[30/30] Training loss: 1.3732	 Validation loss: 6.1781
smape score:  15.7288
------------------------------
LAGS + ACTIVE
Preparing shift feature...
Data shape:  (128535, 16)
train shape:  (87780, 28)
val shape:  (3135, 28)
Preparing new active & adult_pop...

Training Features:  ['year', 'month', 'pct_bb', 'pct_college', 'pct_foreign_born', 'pct_it_workers', 'median_hh_inc', 'mbd_lag_1', 'mbd_lag_2', 'mbd_lag_3', 'mbd_lag_4', 'mbd_lag_5', 'mbd_lag_6', 'mbd_lag_7', 'mbd_lag_8', 'mbd_lag_9', 'mbd_lag_10', 'mbd_lag_11', 'mbd_lag_12', 'active', 'adult_pop']
train shape:  (84645, 28)
val shape:  (3135, 28)

Model:  xgbregressor
smape score:  2.1674

Model:  lgbmregressor
smape score:  2.1617

model: nn.Linear
[1/6] Training loss: 21.2802	 Validation loss: 19.9954
[2/6] Training loss: 6.2208	 Validation loss: 14.8488
[3/6] Training loss: 3.9352	 Validation loss: 13.0941
[4/6] Training loss: 3.4478	 Validation loss: 12.1154
[5/6] Training loss: 3.0722	 Validation loss: 10.5344
[6/6] Training loss: 2.7833	 Validation loss: 8.6631
smape score:  52.1751

model: LSTM
[5/30] Training loss: 6.5569	 Validation loss: 19.5907
[10/30] Training loss: 3.8216	 Validation loss: 16.6483
[15/30] Training loss: 3.3953	 Validation loss: 13.8050
[20/30] Training loss: 2.9974	 Validation loss: 13.2726
[25/30] Training loss: 2.2757	 Validation loss: 8.6917
[30/30] Training loss: 2.1712	 Validation loss: 11.5460
smape score:  38.52219

model: GRU
[5/30] Training loss: 5.8820	 Validation loss: 21.9092
[10/30] Training loss: 3.7876	 Validation loss: 16.3327
[15/30] Training loss: 3.4881	 Validation loss: 18.1246
[20/30] Training loss: 2.4663	 Validation loss: 10.8834
[25/30] Training loss: 1.8518	 Validation loss: 10.4403
[30/30] Training loss: 1.9534	 Validation loss: 8.6404
smape score:  40.80285
------------------------------
ALL
Preparing shift feature...
Data shape:  (128535, 16)
train shape:  (87780, 28)
val shape:  (3135, 28)
Preparing cfips feature...
Preparing new active & adult_pop...

Training Features:  ['year', 'month', 'pct_bb', 'pct_college', 'pct_foreign_born', 'pct_it_workers', 'median_hh_inc', 'mbd_lag_1', 'mbd_lag_2', 'mbd_lag_3', 'mbd_lag_4', 'mbd_lag_5', 'mbd_lag_6', 'mbd_lag_7', 'mbd_lag_8', 'mbd_lag_9', 'mbd_lag_10', 'mbd_lag_11', 'mbd_lag_12', 'microbusiness_density_mean', 'microbusiness_density_std', 'trend', 'active', 'adult_pop']
train shape:  (84645, 31)
val shape:  (3135, 31)

Model:  xgbregressor
smape score:  2.3281

Model:  lgbmregressor
smape score:  2.2443

model: nn.Linear
[1/6] Training loss: 22.5337	 Validation loss: 29.1374
[2/6] Training loss: 5.2155	 Validation loss: 7.1668
[3/6] Training loss: 2.9889	 Validation loss: 6.1316
[4/6] Training loss: 2.7340	 Validation loss: 5.1565
[5/6] Training loss: 2.5256	 Validation loss: 4.4523
[6/6] Training loss: 2.3512	 Validation loss: 4.0966
smape score:  9.96504

model: LSTM
[5/30] Training loss: 6.3515	 Validation loss: 15.6536
[10/30] Training loss: 3.7354	 Validation loss: 11.2816
[15/30] Training loss: 2.8325	 Validation loss: 8.2946
[20/30] Training loss: 2.4980	 Validation loss: 7.2735
[25/30] Training loss: 2.1340	 Validation loss: 7.5176
[30/30] Training loss: 1.6066	 Validation loss: 6.9172
smape score:  11.5593

model: GRU
[5/30] Training loss: 5.8544	 Validation loss: 14.4602
[10/30] Training loss: 3.3217	 Validation loss: 10.5572
[15/30] Training loss: 3.2390	 Validation loss: 9.8099
[20/30] Training loss: 2.4034	 Validation loss: 5.8773
[25/30] Training loss: 2.4453	 Validation loss: 5.6817
[30/30] Training loss: 1.5483	 Validation loss: 5.8770
smape score:  18.48425
------------------------------
